<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Loading...</title>

    <!-- Open Graph meta tags - will be updated by script -->
    <meta property="og:title" content="Loading..." />
    <meta property="og:description" content="" />
    <meta property="og:image" content="" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4VY4NFKS38"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-4VY4NFKS38');
    </script>

    <script src="https://t.contentsquare.net/uxa/a96e749c7603c.js"></script>

    <!-- ðŸŸ£ OG metadata loader (synchronous for social crawlers) -->
    <script>
      (function() {
        const slug = new URLSearchParams(window.location.search).get("slug");
        if (!slug) return;

        const xhr = new XMLHttpRequest();
        xhr.open("GET", `../assets/data/post-${slug}.json`, false);
        xhr.send(null);

        if (xhr.status === 200) {
          try {
            const post = JSON.parse(xhr.responseText);

            document.title = post.title;

            const ogImageUrl = post.thumbnail.src.startsWith("http")
              ? post.thumbnail.src
              : new URL(post.thumbnail.src, window.location.origin).href;

            const updateMetaTag = (property, content) => {
              let meta = document.querySelector(`meta[property="${property}"]`);
              if (!meta) {
                meta = document.createElement("meta");
                meta.setAttribute("property", property);
                document.head.appendChild(meta);
              }
              meta.setAttribute("content", content);
            };

            updateMetaTag("og:title", post.title);
            updateMetaTag("og:description", post.subtitle);
            updateMetaTag("og:image", ogImageUrl);
            updateMetaTag("og:type", "article");
            updateMetaTag("og:url", window.location.href);

          } catch (e) {
            console.error("Error parsing post data:", e);
          }
        }
      })();
    </script>

    <!-- ðŸŸ£ Google Fonts (Pacifico + DM Sans) â†’ ë¡œê³  í°íŠ¸ ë¬¸ì œ í•´ê²° âœ” -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Pacifico&display=swap"
      rel="stylesheet"
    />

    <!-- í•œêµ­ì–´ ë³¸ë¬¸ìš© í°íŠ¸ -->
    <link
      href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square-round.css"
      rel="stylesheet"
    />

    <!-- Style -->
    <link rel="stylesheet" href="../styles/style.css" />
  </head>

  <body>
    <!-- Navbar will be injected dynamically by script.js -->
    <main></main>

    <!-- Scripts -->
    <script src="../scripts/script.js"></script>
    <script src="../scripts/post.js"></script>
  </body>
</html>
